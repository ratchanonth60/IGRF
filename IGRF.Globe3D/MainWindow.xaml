<Window x:Class="IGRF.Globe3D.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:helix="http://helix-toolkit.org/wpf"
        mc:Ignorable="d"
        Title="🌐 IGRF 3D Earth Globe - Magnetic Field Visualization" 
        Height="700" Width="1100"
        Background="#0A0A0A"
        WindowStartupLocation="CenterScreen">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#1A1A1A" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="🌍 IGRF 3D Earth Globe" FontSize="20" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                    <TextBlock Text="Magnetic Field Visualization" Foreground="#888888" FontSize="14" Margin="15,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Reset View" Click="ResetView_Click" 
                            Background="#2A5A8A" Foreground="White" Padding="15,8" Margin="5,0"
                            BorderThickness="0" Cursor="Hand"/>
                    <CheckBox x:Name="ShowFieldLinesCheck" Content="Field Lines" 
                              IsChecked="True" Foreground="White" VerticalAlignment="Center" Margin="10,0"
                              Checked="ShowFieldLines_Changed" Unchecked="ShowFieldLines_Changed"/>
                    <CheckBox x:Name="ShowInclinationCheck" Content="Inclination" 
                              IsChecked="True" Foreground="White" VerticalAlignment="Center" Margin="10,0"
                              Checked="ShowInclination_Changed" Unchecked="ShowInclination_Changed"/>
                    <TextBlock x:Name="ConnectionDebug" Text="Status: Disconnected" Foreground="#AAAAAA" FontSize="12" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <CheckBox x:Name="TrackSatelliteCheck" Content="Track Satellite" Foreground="Cyan" VerticalAlignment="Center" Margin="15,0,0,0"/>
                    <!-- Color Legend -->
                    <Border Background="#333" CornerRadius="3" Padding="8,4" Margin="15,0,0,0">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="15" Height="15" Fill="Blue" Margin="0,0,5,0"/>
                            <TextBlock Text="-90°" Foreground="White" FontSize="10" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <Rectangle Width="15" Height="15" Fill="LimeGreen" Margin="0,0,5,0"/>
                            <TextBlock Text="0°" Foreground="White" FontSize="10" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <Rectangle Width="15" Height="15" Fill="Red" Margin="0,0,5,0"/>
                            <TextBlock Text="+90°" Foreground="White" FontSize="10" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- 3D Viewport -->
        <helix:HelixViewport3D x:Name="Viewport3D" Grid.Row="1" 
                                Background="#0A0A0A"
                                ShowCoordinateSystem="True" 
                                CoordinateSystemLabelForeground="White"
                                CameraRotationMode="Turnball"
                                ZoomExtentsWhenLoaded="True">
            
            <!-- Camera -->
            <helix:HelixViewport3D.Camera>
                <PerspectiveCamera Position="0, 0, 25" 
                                   LookDirection="0, 0, -25"
                                   UpDirection="0, 1, 0"
                                   FieldOfView="45"/>
            </helix:HelixViewport3D.Camera>
            
            <!-- Starfield Background -->
            <ModelVisual3D x:Name="StarfieldContainer"/>
            
            <!-- Lights -->
            <helix:SunLight/>
            <ModelVisual3D>
                <ModelVisual3D.Content>
                    <AmbientLight Color="#303030"/>
                </ModelVisual3D.Content>
            </ModelVisual3D>
            
            <!-- Earth Sphere with Enhanced Material -->
            <helix:SphereVisual3D x:Name="EarthSphere" 
                                   Center="0, 0, 0" 
                                   Radius="6.371" 
                                   ThetaDiv="128" 
                                   PhiDiv="64">
                <helix:SphereVisual3D.Material>
                    <MaterialGroup>
                        <DiffuseMaterial>
                            <DiffuseMaterial.Brush>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                    <GradientStop Color="#0D47A1" Offset="0.0"/>
                                    <GradientStop Color="#1976D2" Offset="0.2"/>
                                    <GradientStop Color="#2E7D32" Offset="0.5"/> <!-- Land-ish green -->
                                    <GradientStop Color="#1565C0" Offset="0.8"/>
                                    <GradientStop Color="#002171" Offset="1.0"/>
                                </LinearGradientBrush>
                            </DiffuseMaterial.Brush>
                        </DiffuseMaterial>
                        <SpecularMaterial SpecularPower="24">
                            <SpecularMaterial.Brush>
                                <SolidColorBrush Color="#80FFFFFF"/>
                            </SpecularMaterial.Brush>
                        </SpecularMaterial>
                    </MaterialGroup>
                </helix:SphereVisual3D.Material>
            </helix:SphereVisual3D>
            
            <!-- Inclination Data Points Container -->
            <ModelVisual3D x:Name="InclinationContainer"/>
            
            <!-- Magnetic Field Lines Container -->
            <ModelVisual3D x:Name="MagneticFieldLinesContainer"/>
            
            <!-- Axis X (Red) -->
            <helix:ArrowVisual3D Point1="0,0,0" Point2="12,0,0" Diameter="0.1" Fill="Red"/>
            <helix:BillboardTextVisual3D Position="13,0,0" Text="X" Foreground="Red" FontSize="16"/>
            
            <!-- Axis Y (Green) -->
            <helix:ArrowVisual3D Point1="0,0,0" Point2="0,12,0" Diameter="0.1" Fill="LimeGreen"/>
            <helix:BillboardTextVisual3D Position="0,13,0" Text="Y (North)" Foreground="LimeGreen" FontSize="16"/>
            
            <!-- Axis Z (Blue) -->
            <helix:ArrowVisual3D Point1="0,0,0" Point2="0,0,12" Diameter="0.1" Fill="DodgerBlue"/>
            <helix:BillboardTextVisual3D Position="0,0,13" Text="Z" Foreground="DodgerBlue" FontSize="16"/>
            
            <!-- Orbit Container -->
            <ModelVisual3D x:Name="OrbitContainer"/>

            <!-- Satellite Marker -->
            <helix:SphereVisual3D x:Name="SatelliteMarker" 
                                   Center="0, 8, 0" 
                                   Radius="0.3" 
                                   Fill="Orange"/>
            
            <!-- Detailed 3D Model Container -->
            <ModelVisual3D x:Name="SatelliteModelContainer"/>

            <helix:BillboardTextVisual3D x:Name="SatelliteLabel" 
                                          Position="0, 8.5, 0" 
                                          Text="Satellite" 
                                          Foreground="Orange" 
                                          FontSize="12"/>
            
        </helix:HelixViewport3D>
    </Grid>
</Window>
